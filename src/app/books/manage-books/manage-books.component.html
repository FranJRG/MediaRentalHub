<div class="manage-books-container">
  <h1 class="title">ðŸ“š Manage books </h1>
  <a routerLink="/books/addBook" data-toggle="tooltip" class="icon-link" data-placement="top" title="Add book">
    <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="bi bi-database-fill-add icon-large" viewBox="0 0 16 16">
      <path d="M12.5 16a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7m.5-5v1h1a.5.5 0 0 1 0 1h-1v1a.5.5 0 0 1-1 0v-1h-1a.5.5 0 0 1 0-1h1v-1a.5.5 0 0 1 1 0M8 1c-1.573 0-3.022.289-4.096.777C2.875 2.245 2 2.993 2 4s.875 1.755 1.904 2.223C4.978 6.711 6.427 7 8 7s3.022-.289 4.096-.777C13.125 5.755 14 5.007 14 4s-.875-1.755-1.904-2.223C11.022 1.289 9.573 1 8 1"/>
      <path d="M2 7v-.839c.457.432 1.004.751 1.49.972C4.722 7.693 6.318 8 8 8s3.278-.307 4.51-.867c.486-.22 1.033-.54 1.49-.972V7c0 .424-.155.802-.411 1.133a4.51 4.51 0 0 0-4.815 1.843A12 12 0 0 1 8 10c-1.573 0-3.022-.289-4.096-.777C2.875 8.755 2 8.007 2 7m6.257 3.998L8 11c-1.682 0-3.278-.307-4.51-.867-.486-.22-1.033-.54-1.49-.972V10c0 1.007.875 1.755 1.904 2.223C4.978 12.711 6.427 13 8 13h.027a4.55 4.55 0 0 1 .23-2.002m-.002 3L8 14c-1.682 0-3.278-.307-4.51-.867-.486-.22-1.033-.54-1.49-.972V13c0 1.007.875 1.755 1.904 2.223C4.978 15.711 6.427 16 8 16c.536 0 1.058-.034 1.555-.097a4.5 4.5 0 0 1-1.3-1.905"/>
    </svg>
  </a>
</div>

<div class="search-container">
  <app-search-box class="search-box" (onSearch)="search($event)"></app-search-box>
</div>

<table class="table">
    <thead>
        <tr>
            <th><button class="btn btn-link" (click)="setPage(pageNumber, 'mediaId', order)">Id</button></th>
            <th><button class="btn btn-link" (click)="setPage(pageNumber, 'title', order)">Title</button></th>
            <th><button class="btn btn-link" (click)="setPage(pageNumber, 'gender', order)">Gender</button></th>
            <th>Author</th>
            <th>Stock</th>
            <th></th>
            <th>Actions</th>
            <th></th>
        </tr>
    </thead>
    <tbody>
        @for (book of books; track $index) {
            @if (book.available === true) {
                <tr>
                    <td>{{ book.media_id }}</td>
                    <td>{{ book.title }}</td>
                    <td>{{ book.gender }}</td>
                    <td>{{ book.author }}</td>
                    <td>{{ book.stock }}</td>
                    <td>
                        <a
                        routerLink="/books/editBook/{{book.media_id}}"
                        class="btn btn-warning"
                        style="margin: 5px;"
                        data-toggle="tooltip" 
                        data-placement="top"
                        title="Edit book"
                        >
                        <svg
                          xmlns="http://www.w3.org/2000/svg"
                          width="15"
                          height="16"
                          fill="currentColor"
                          class="bi bi-pencil-square"
                          viewBox="0 0 16 16"
                        >
                          <path
                            d="M15.502 1.94a.5.5 0 0 1 0 .706L14.459 3.69l-2-2L13.502.646a.5.5 0 0 1 .707 0l1.293 1.293zm-1.75 2.456-2-2L4.939 9.21a.5.5 0 0 0-.121.196l-.805 2.414a.25.25 0 0 0 .316.316l2.414-.805a.5.5 0 0 0 .196-.12l6.813-6.814z"
                          />
                          <path
                            fill-rule="evenodd"
                            d="M1 13.5A1.5 1.5 0 0 0 2.5 15h11a1.5 1.5 0 0 0 1.5-1.5v-6a.5.5 0 0 0-1 0v6a.5.5 0 0 1-.5.5h-11a.5.5 0 0 1-.5-.5v-11a.5.5 0 0 1 .5-.5H9a.5.5 0 0 0 0-1H2.5A1.5 1.5 0 0 0 1 2.5z"
                          />
                        </svg>
                      </a>
                    </td>
                    <td></td>
                    <td>
                        <button
                            class="btn btn-danger"
                            (click)="deleteBook(book.media_id)"
                            style="margin: 5px"
                            data-toggle="tooltip" 
                            data-placement="top" 
                            title="Delete book"
                            >
                            <svg
                                xmlns="http://www.w3.org/2000/svg"
                                width="16"
                                height="16"
                                fill="currentColor"
                                class="bi bi-trash-fill"
                                viewBox="0 0 16 16"
                            >
                                <path
                                d="M2.5 1a1 1 0 0 0-1 1v1a1 1 0 0 0 1 1H3v9a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2V4h.5a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H10a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1zm3 4a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-1 0v-7a.5.5 0 0 1 .5-.5M8 5a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-1 0v-7A.5.5 0 0 1 8 5m3 .5v7a.5.5 0 0 1-1 0v-7a.5.5 0 0 1 1 0"
                                />
                            </svg>
                            </button>
                    </td>
                </tr>
            }
        }
    </tbody>
</table>

@if (page) {
<div class="pagination-container">
    Total Items: <a>{{ totalItems }}</a>
    @if (pageNumber > 1) {
    <a (click)="setPage(1, sortField, order)" href="javascript:void(0)">First</a>
    }@else {
    <span class="disabled">First</span>
    } @if (pageNumber > 1) {
    <a
      (click)="setPage(page.pageable.pageNumber, sortField, order)"
      href="javascript:void(0)"
      >Previous</a
    >
    }@else {
    <span class="disabled">Previous</span>
    } @for (i of getPageNumbers(); track $index) {
    <span>
      <a
        *ngIf="pageNumber !== i"
        (click)="setPage(i, sortField, order)"
        href="javascript:void(0)"
        >{{ i }}</a
      >
      <span *ngIf="pageNumber === i"
        ><a class="current-page">{{ i }}</a></span
      >
      &nbsp;
    </span>
    } @if (pageNumber < page.totalPages) {
    <a (click)="setPage(nextPage(), sortField, order)" href="javascript:void(0)"
      >Next</a
    >
    }@else {
    <span class="disabled">Next</span>
    } @if (pageNumber < page.totalPages) {
    <a
      (click)="setPage(page.totalPages, sortField, order)"
      href="javascript:void(0)"
      >Last</a
    >
    }@else {
    <span class="disabled">Last</span>
    }
  </div>
  
}